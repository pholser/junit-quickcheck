<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at March 11, 2016 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160311" />
    <meta http-equiv="Content-Language" content="en" />
    <title>junit-quickcheck &#x2013; Configuring generators</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>junit-quickcheck</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 0.6
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: March 11, 2016</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">junit-quickcheck</li>
                              
      <li>
  
                          <a href="../index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../download.html" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                
      <li>
  
                          <a href="../javadoc.html" title="Javadoc">
          <span class="none"></span>
        Javadoc</a>
            </li>
                
      <li>
  
                          <a href="../discuss.html" title="Discuss">
          <span class="none"></span>
        Discuss</a>
            </li>
                
      <li>
  
                          <a href="../license.html" title="License">
          <span class="none"></span>
        License</a>
            </li>
                              <li class="nav-header">Use</li>
                              
      <li>
  
                          <a href="../usage/getting-started.html" title="Getting Started">
          <span class="none"></span>
        Getting Started</a>
            </li>
                
      <li>
  
                          <a href="../usage/basic-types.html" title="Basic Types">
          <span class="none"></span>
        Basic Types</a>
            </li>
                
      <li>
  
                          <a href="../usage/other-types.html" title="Generating Values of Other Types">
          <span class="none"></span>
        Generating Values of Other Types</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Configuring Generators</a>
          </li>
                
      <li>
  
                          <a href="../usage/constraining.html" title="Constraining Generated Values">
          <span class="none"></span>
        Constraining Generated Values</a>
            </li>
                
      <li>
  
                          <a href="../usage/sample-size.html" title="Sample Size">
          <span class="none"></span>
        Sample Size</a>
            </li>
                
      <li>
  
                          <a href="../usage/seed.html" title="Seed">
          <span class="none"></span>
        Seed</a>
            </li>
                
      <li>
  
                          <a href="../usage/shrinking.html" title="Shrinking">
          <span class="none"></span>
        Shrinking</a>
            </li>
                              <li class="nav-header">Background</li>
                              
      <li>
  
                          <a href="../background/history.html" title="History">
          <span class="none"></span>
        History</a>
            </li>
                
      <li>
  
                          <a href="../background/migrating.html" title="Migrating from Theories">
          <span class="none"></span>
        Migrating from Theories</a>
            </li>
                
      <li>
  
                          <a href="../background/similar-projects.html" title="Similar Projects">
          <span class="none"></span>
        Similar Projects</a>
            </li>
                              <li class="nav-header">Miscellaneous</li>
                              
      <li>
  
                          <a href="../source-repository.html" title="Source Repository">
          <span class="none"></span>
        Source Repository</a>
            </li>
                
      <li>
  
                          <a href="../issue-tracking.html" title="Issue Tracking">
          <span class="none"></span>
        Issue Tracking</a>
            </li>
                
      <li>
  
                          <a href="../team-list.html" title="Team">
          <span class="none"></span>
        Team</a>
            </li>
                
      <li>
  
                          <a href="../dependency-management.html" title="Dependency Management">
          <span class="none"></span>
        Dependency Management</a>
            </li>
                
      <li>
  
                          <a href="../distribution-management.html" title="Distribution Management">
          <span class="none"></span>
        Distribution Management</a>
            </li>
                
      <li>
  
                          <a href="../plugin-management.html" title="Plugin Management">
          <span class="none"></span>
        Plugin Management</a>
            </li>
                
      <li>
  
                          <a href="../plugins.html" title="Plugins">
          <span class="none"></span>
        Plugins</a>
            </li>
                              <li class="nav-header">Reports</li>
                              
      <li>
  
                          <a href="../reports/reports-core.html" title="junit-quickcheck-core">
          <span class="none"></span>
        junit-quickcheck-core</a>
            </li>
                
      <li>
  
                          <a href="../reports/reports-generators.html" title="junit-quickcheck-generators">
          <span class="none"></span>
        junit-quickcheck-generators</a>
            </li>
                
      <li>
  
                          <a href="../reports/reports-guava.html" title="junit-quickcheck-guava">
          <span class="none"></span>
        junit-quickcheck-guava</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Configuring generators</h1>
<p>If you mark a property parameter with an annotation that is itself marked as <tt>@GeneratorConfiguration</tt>, then if the <tt>Generator</tt> for that parameter&#x2019;s type has a public method named <tt>configure</tt> that accepts a single argument of the annotation type, JUnit-Quickcheck will call the <tt>configure</tt> method reflectively, passing it the annotation. The call will take place **before** the call to <tt>generate</tt>, ensuring that the configured value will be in position so to influence the behavior of the generator at the next run.</p>

<div class="source">
<div class="source"><pre class="prettyprint">    
    @GeneratorConfiguration
    public @interface Positive {}

    public class PositiveGenerator extends Generator&lt;Integer&gt; {
        private Positive positive;

        @Override
        public Integer generate(
            SourceOfRandomness random,
            GenerationStatus status) {

            int value = random.nextInt();
            return positive != null ? Math.abs(value) : value;
        }

        public void configure(Positive p) {
            this.positive = p;
        }
    }

    @RunWith(JUnitQuickcheck.class)
    public class Numbers {
        @Property
        public void holds(@Positive int i) {
            assertTrue(i > 0);
        }
    }
</pre></div></div>
<p>Let's illustrate this example by starting from the bottom:
<ol>
<li>Test method parameter <tt>i</tt> is marked as having to be <tt>@Positive</tt>, whatever this may mean to the system - of course we'll make sure that this corresponds to generating strictly positive integer values for the test method.</li>
<li>A class belonging to the JUnit-Quickcheck <tt>Generator</tt> hyerarchy is found on the classpath, and it has a <tt>configure(Positive p)</tt> method.</li>
<li>Annotation interface <tt>Positive</tt> is marked as a <tt>@GeneratorConfiguration</tt>.</li>
<li></li>
</ol><br/>
All this leads to JUnit-Quickcheck understanding that the <tt>public Integer generate</tt> method of <tt>PositiveGenerator</tt> class has to be used to generate <tt>Positive</tt> values for the test method <tt>Numbers.holds</tt>.</p>
<p>A <tt>Generator</tt> can have many such <tt>configure</tt> methods.</p>
<p>Please note that the generation mechanism for the Positive interface can be specified and focused also using annotations, as the following "Aggregating configuration" paragraph illustrates.</p>

<div class="section">
<h2><a name="Configuration_on_type_uses"></a>Configuration on type uses</h2>
<p>Configuration annotations that can target type uses will be honored:</p>

<div class="source">
<div class="source"><pre class="prettyprint">    @RunWith(JUnitQuickcheck.class)
    public class PropertiesOfListsOfSingleDigits {
        @Property
        public void hold(
            List&lt;@InRange(min = &quot;0&quot;, max = &quot;9&quot;) Integer&gt; digits) {
                // ...
        }
    }
</pre></div></div></div>
<div class="section">
<h2><a name="Configuration_on_types_in_a_hierarchy"></a>Configuration on types in a hierarchy</h2>
<p>Recall that potentially many generators can satisfy a given property parameter based on its type:</p>

<div class="source">
<div class="source"><pre class="prettyprint">    @RunWith(JUnitQuickcheck.class)
    public class SerializationProperties {
        @Property public void hold(
            @InRange(min = &quot;0&quot;, max = &quot;10&quot;) Serializable s) {
                // ...
        }
    }
</pre></div></div>
<p>Only the available generators that can produce something that is <tt>java.io.Serializable</tt> <i>and</i> that support all the configuration annotations on a property parameter will be called on to generate a value for that parameter. So, for example, for parameter <tt>s</tt> above, generators for integral values might be called upon, whereas generators for <tt>ArrayList</tt>s would not. junit-quickcheck will complain loudly if there are no such generators available.</p>
<p>If you have a family of generators that can produce members of a hierarchy, you may want to ensure that all the generators respect the same attributes of a given configuration annotation. Not doing so could lead to surprising results.</p></div>
<div class="section">
<h2><a name="Aggregating_configuration"></a>Aggregating configuration</h2>
<p>Configuration annotations that are directly on a property parameter, and any configuration annotations on annotations that are directly on a property parameter (and so on&#x2026;) are collected to configure the generator(s) for the parameter:</p>

<div class="source">
<div class="source"><pre class="prettyprint">
    @Target({PARAMETER, FIELD, ANNOTATION_TYPE, TYPE_USE})
    @Retention(RUNTIME)
    @From(MoneyGenerator.class)
    @InRange(min = &quot;0&quot;, max = &quot;20&quot;)
    @Precision(scale = 2)
    public @interface SmallChange {
    }

    @RunWith(JUnitQuickcheck.class)
    public class Monies {
        @Property
        public void hold(@SmallChange BigDecimal d) {
            assertEquals(2, d.scale());
            assertThat(
                d,
                allOf(
                    greaterThanOrEqualTo(BigDecimal.ZERO),
                    lessThanOrEqualTo(new BigDecimal(&quot;20&quot;))));
        }
    }
</pre></div></div>
<p>In this code, class <tt>MoneyGenerator extends Generator&lt;BigDecimal&gt;</tt> will obviously need to have a 
<tt>public BigDecimal generate(SourceOfRandomness r, GenerationStatus s)</tt> method producing small change the way we wish. In case we forget to implement there the control that amount be less or equal than 20, annotation <tt>@InRange</tt> will see to it that no value higher than 20 be fed as a parameter to any JUnit test method that like <tt>Monies.hold</tt> accepts <tt>SmallChange</tt> values as input.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2016.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
