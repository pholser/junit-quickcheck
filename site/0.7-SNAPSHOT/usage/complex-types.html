<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at April 21, 2016 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160421" />
    <meta http-equiv="Content-Language" content="en" />
    <title>junit-quickcheck &#x2013; Generating values of more complex types</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>junit-quickcheck</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 0.7-SNAPSHOT
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: April 21, 2016</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">junit-quickcheck</li>
                              
      <li>
  
                          <a href="../index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../download.html" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                
      <li>
  
                          <a href="../javadoc.html" title="Javadoc">
          <span class="none"></span>
        Javadoc</a>
            </li>
                
      <li>
  
                          <a href="../discuss.html" title="Discuss">
          <span class="none"></span>
        Discuss</a>
            </li>
                
      <li>
  
                          <a href="../license.html" title="License">
          <span class="none"></span>
        License</a>
            </li>
                              <li class="nav-header">Use</li>
                              
      <li>
  
                          <a href="../usage/getting-started.html" title="Getting Started">
          <span class="none"></span>
        Getting Started</a>
            </li>
                
      <li>
  
                          <a href="../usage/basic-types.html" title="Basic Types">
          <span class="none"></span>
        Basic Types</a>
            </li>
                
      <li>
  
                          <a href="../usage/other-types.html" title="Generating Values of Other Types">
          <span class="none"></span>
        Generating Values of Other Types</a>
            </li>
                
      <li>
  
                          <a href="../usage/configuring.html" title="Configuring Generators">
          <span class="none"></span>
        Configuring Generators</a>
            </li>
                
      <li>
  
                          <a href="../usage/constraining.html" title="Constraining Generated Values">
          <span class="none"></span>
        Constraining Generated Values</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Generating Values of Complex Types</a>
          </li>
                
      <li>
  
                          <a href="../usage/sample-size.html" title="Sample Size">
          <span class="none"></span>
        Sample Size</a>
            </li>
                
      <li>
  
                          <a href="../usage/seed.html" title="Seed">
          <span class="none"></span>
        Seed</a>
            </li>
                
      <li>
  
                          <a href="../usage/shrinking.html" title="Shrinking">
          <span class="none"></span>
        Shrinking</a>
            </li>
                              <li class="nav-header">Background</li>
                              
      <li>
  
                          <a href="../background/history.html" title="History">
          <span class="none"></span>
        History</a>
            </li>
                
      <li>
  
                          <a href="../background/migrating.html" title="Migrating from Theories">
          <span class="none"></span>
        Migrating from Theories</a>
            </li>
                
      <li>
  
                          <a href="../background/similar-projects.html" title="Similar Projects">
          <span class="none"></span>
        Similar Projects</a>
            </li>
                              <li class="nav-header">Miscellaneous</li>
                              
      <li>
  
                          <a href="../source-repository.html" title="Source Repository">
          <span class="none"></span>
        Source Repository</a>
            </li>
                
      <li>
  
                          <a href="../issue-tracking.html" title="Issue Tracking">
          <span class="none"></span>
        Issue Tracking</a>
            </li>
                
      <li>
  
                          <a href="../team-list.html" title="Team">
          <span class="none"></span>
        Team</a>
            </li>
                
      <li>
  
                          <a href="../dependency-management.html" title="Dependency Management">
          <span class="none"></span>
        Dependency Management</a>
            </li>
                
      <li>
  
                          <a href="../distribution-management.html" title="Distribution Management">
          <span class="none"></span>
        Distribution Management</a>
            </li>
                
      <li>
  
                          <a href="../plugin-management.html" title="Plugin Management">
          <span class="none"></span>
        Plugin Management</a>
            </li>
                
      <li>
  
                          <a href="../plugins.html" title="Plugins">
          <span class="none"></span>
        Plugins</a>
            </li>
                              <li class="nav-header">Reports</li>
                              
      <li>
  
                          <a href="../reports/reports-core.html" title="junit-quickcheck-core">
          <span class="none"></span>
        junit-quickcheck-core</a>
            </li>
                
      <li>
  
                          <a href="../reports/reports-generators.html" title="junit-quickcheck-generators">
          <span class="none"></span>
        junit-quickcheck-generators</a>
            </li>
                
      <li>
  
                          <a href="../reports/reports-guava.html" title="junit-quickcheck-guava">
          <span class="none"></span>
        junit-quickcheck-guava</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Generating values of more complex types</h1>
<p>Generators for complex types have many options for generating constituent values.</p>
<div class="section">
<h2><a name="Using_the_SourceOfRandomness_handed_to_the_generator_directly"></a>Using the <tt>SourceOfRandomness</tt> handed to the generator directly</h2>

<div class="source">
<div class="source"><pre class="prettyprint">    public class PolygonGenerator extends Generator&lt;Polygon&gt; {
        @Override public Polygon generate(
            SourceOfRandomness r,
            GenerationStatus status) {

            int numberOfPoints = Math.abs(r.nextInt());

            int xs = new int[numberOfPoints];
            for (int i = 0; i &lt; numberOfPoints; ++i)
                xs[i] = r.nextInt();

            int ys = new int[numberOfPoints];
            for (int i = 0; i &lt; numberOfPoints; ++i)
                ys[i] = r.nextInt();

            return new Polygon(xs, ys, numberOfPoints);
        }
    }
</pre></div></div></div>
<div class="section">
<h2><a name="Embedding_other_generators_as_fields_of_the_generator_calling_upon_them_as"></a>Embedding other generators as fields of the generator, calling upon them as</h2>
<p>necessary</p>

<div class="source">
<div class="source"><pre class="prettyprint">    public class NonNegativeInts extends Generator&lt;Integer&gt; {
        // ...

        @Override public Integer generate(
            SourceOfRandomness random,
            GenerationStatus status) {

            return Math.abs(random.nextInt());
        }
    }

    public class Counter {
        private int count;

        public Counter(int count) {
            this.count = count;
        }

        // ...
    }

    public class Counters extends Generator&lt;Counter&gt; {
        private final Generator&lt;Integer&gt; nonNegatives =
            new NonNegativeInts();

        // ...

        @Override public Counter generate(
            SourceOfRandomness random,
            GenerationStatus status) {

            return new Counter(nonNegatives.generate(random, status));
        }
    }
</pre></div></div></div>
<div class="section">
<h2><a name="Asking_for_a_generator_for_values_of_a_specific_type_via_gen"></a>Asking for a generator for values of a specific type via <tt>gen()</tt></h2>
<p>Generators that are made available to the <tt>ServiceLoader</tt> or referenced via <tt>@From</tt> can access other such generators via the superclass method <tt>gen()</tt>.</p>

<ul>
  
<li><tt>gen().type(...)</tt></li>
</ul>
<p>This method asks for an arbitrary generator that can produce instances of the given type.</p>

<div class="source">
<div class="source"><pre class="prettyprint">    public class Counter {
        private int count;

        public Counter(int count) {
            this.count = count;
        }

        // ...
    }

    public class Counters extends Generator&lt;Counter&gt; {
        // ...
        @Override public Counter generate(
            SourceOfRandomness random,
            GenerationStatus status) {

            return new Counter(
                Math.abs(gen().type(int.class).generate(random, status))
            );
        }
    }
</pre></div></div>

<ul>
  
<li><tt>gen.constructor(...)</tt></li>
</ul>
<p>This method gives a generator that produces instances of the given type by invoking a constructor reflectively, generating random values for the constructor&#x2019;s arguments using available generators. This works a lot like annotating a property parameter with <tt>@From(Ctor.class)</tt>. Any <a href="configuring.html">configuration annotations</a> on the constructor parameters will be honored.</p>

<div class="source">
<div class="source"><pre class="prettyprint">    public class Counter {
        private int count;

        public Counter(int count) {
            this.count = count;
        }

        // ...
    }

    public class TrafficTracker {
        private final Counter counter;

        public TrafficTracker(Counter counter) {
            this.counter = counter;
        }
    }

    public class TrafficTrackers extends Generator&lt;TrafficTracker&gt; {
        // ...
        @Override public Counter generate(
            SourceOfRandomness random,
            GenerationStatus status) {

            return new TrafficTracker(
                gen().constructor(Counter.class, int.class)
                    .generate(random, status));
        }
    }
</pre></div></div>

<ul>
  
<li><tt>gen.fieldsOf(...)</tt></li>
</ul>
<p>This method gives a generator that produces instances of the given type by instantiating using an accessible zero-arg constructor, and generating random values for the instance&#x2019;s fields using available generators. This works a lot like annotating a property parameter with <tt>@From(Fields.class)</tt>. Any <a href="configuring.html">configuration annotations</a> on the fields will be honored.</p>

<div class="source">
<div class="source"><pre class="prettyprint">    public class Counter {
        private int count;

        // ...
    }

    public class TrafficTracker {
        private final Counter counter;

        public TrafficTracker(Counter counter) {
            this.counter = counter;
        }
    }

    public class TrafficTrackers extends Generator&lt;TrafficTracker&gt; {
        // ...
        @Override public Counter generate(
            SourceOfRandomness random,
            GenerationStatus status) {

            return new TrafficTracker(
                gen().fieldsOf(Counter.class).generate(random, status));
        }
    }
</pre></div></div>

<ul>
  
<li><tt>gen.parameter(...)</tt></li>
</ul>
<p>This method gives a generator that can produce instances of the type of the given reflected method parameter, and that honors all of the configuration annotations on the parameter.</p>

<ul>
  
<li><tt>gen.field(Class&lt;?&gt;, String)</tt></li>
</ul>
<p>This method gives a generator that can produce instances of the type of the field of a given name on the given type, and that honors all of the configuration annotations on the field.</p>

<ul>
  
<li><tt>gen.field(Field)</tt></li>
</ul>
<p>This method gives a generator that can produce instances of the type of the given reflected field, and that honors all of the configuration annotations on the field.</p>
<h1>Generators for types with component types: <tt>ComponentizedGenerator</tt></h1>
<p>Extend <tt>ComponentizedGenerator</tt> instead of <tt>Generator</tt> when the type of values you need to generate have component types; for example, collections, maps. This is usually necessary for generating values for types that involve generics.</p>

<div class="source">
<div class="source"><pre class="prettyprint">    public final class Either&lt;L, R&gt; {
        private final Optional&lt;L&gt; left;
        private final Optional&lt;R&gt; right;

        private Either(Optional&lt;L&gt; left, Optional&lt;R&gt; right) {
            this.left = left;
            this.right = right;
        }

        public static &lt;A, B&gt; Either&lt;A, B&gt; makeLeft(A left) {
            return new Either&lt;&gt;(Optional.of(left), Optional.empty());
        }

        public static &lt;A, B&gt; Either&lt;A, B&gt; makeRight(B right) {
            return new Either&lt;&gt;(Optional.empty(), Optional.of(right));
        }

        public &lt;T&gt; T map(
            Function&lt;? super L, ? extends T&gt; ifLeft,
            Function&lt;? super R, ? extends T&gt; ifRight) {

            return left.map(ifLeft).orElseGet(() -&gt; right.map(ifRight).get());
        }

        @Override public boolean equals(Object o) {
            if (o == this)
                return true;
            if (!(o instanceof Either&lt;?, ?&gt;))
                return false;

            Either&lt;?, ?&gt; other = (Either&lt;?, ?&gt;) o;
            return left.equals(other.left) &amp;&amp; right.equals(other.right);
        }

        @Override public int hashCode() {
            return Objects.hash(left, right);
        }

        @Override public String toString() {
            return map(
                left -&gt; &quot;Left[&quot; + left + ']',
                right -&gt; &quot;Right[&quot; + right + ']');
        }
    }

    public class EitherGenerator extends ComponentizedGenerator&lt;Either&gt; {
        public EitherGenerator() {
            super(Either.class);
        }

        @Override public Either&lt;?, ?&gt; generate(
            SourceOfRandomness random,
            GenerationStatus status) {


            return random.nextBoolean()
                ? Either.createLeft(componentGenerators().get(0).generate(random, status))
                : Either.createLeft(componentGenerators().get(0).generate(random, status));
        }

        @Override public int numberOfNeededComponents() {
            return 2;
        }
    }

    @RunWith(JUnitQuickcheck.class)
    public class Eithers {
        @Property public void constrained(
            Either&lt;
                @InRange(minInt = 0) Integer,
                @InRange(minDouble = -7.0, maxDouble = -4.0) Double&gt; e) {

            e.map(
                left -&gt; {
                    assertThat(left, greaterThanOrEqualTo(0));
                    return 0;
                },
                right -&gt; {
                    assertThat(
                        right,
                        allOf(greaterThanOrEqualTo(-7.0), lessThanOrEqualTo(-4.0)));
                    return 1;
                }
            );
        }
    }
</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2016.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
